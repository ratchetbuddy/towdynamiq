<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Get a Tow Quote - Towdynamiq</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h1>Get a Tow Quote</h1>

    <div id="current-datetime" style="font-weight: bold; margin-bottom: 15px;">
      <!-- JavaScript will update this -->
    </div>

    <form id="quote-form">
      
    <fieldset id="need_tow">
      <legend>Do you need a tow?</legend>
      <label>
        <input type="radio" name="need_tow" value="yes" > Yes
      </label>
      <label>
        <input type="radio" name="need_tow" value="no" required> No
      </label>
    </fieldset><br>

    <fieldset id="is_accident">
      <legend>Was this due to an accident?</legend>
      <label>
        <input type="radio" name="is_accident" value="yes" required> Yes
      </label>
      <label>
        <input type="radio" name="is_accident" value="no"> No
      </label>
    </fieldset><br>

    <fieldset id="vehicle_location">
      <legend>Is the vehicle currently in a safe location?</legend>
      <label>
        <input type="radio" name="vehicle_location" value="yes" required> Yes
      </label>
      <label>
        <input type="radio" name="vehicle_location" value="no"> No
      </label>
    </fieldset><br>

    <div id="unsafe_location" style="display:none;">
      <label for="unsafe_location_select">Exact vehicle location:</label>
      <select id="unsafe_location_select" name="unsafe_location">
        <option value="">-- Select Location --</option>
        {% for road_type, road_data in dynamic_modifiers.vehicle_location.items() %}
          <optgroup label="{{ road_data.label }}">
            {% for lane, lane_data in road_data.lanes.items() %}
              <option value="{{ lane }}" data-road-type="{{ road_type }}">
                {{ lane_data.label }}
              </option>
            {% endfor %}
          </optgroup>
        {% endfor %}
      </select>
    </div><br>

    <div>
      <!-- Make -->
      <label for="make_input">Make:</label>
      <input list="make_list" id="make_input" name="make" placeholder="Start typing a make...">

      <datalist id="make_list">
        {% for make_key, make_data in cars.items() %}
          <option value="{{ make_key }}">{{ make_data.label }}</option>
        {% endfor %}
      </datalist><br><br>

      <!-- Model -->
      <label for="model_input">Model:</label>
      <input list="model_list" id="model_input" name="model" placeholder="Start typing a model..." disabled>

      <datalist id="model_list">
        <!-- JS will populate this -->
      </datalist>
    </div><br>

      <label for="tow_type">Tow Type:</label>
      <select id="tow_type" name="tow_type" required>
        {% for tow_type in pricing.keys() %}
          <option value="{{ tow_type }}">{{ tow_type }}</option>
        {% endfor %}
      </select><br>

      
      <div id="extra-services"></div><br>

      <div id="service-limit-msg"></div><br>

      <div id = "distance">
        <label for="distance_value">Distance (miles):</label>
        <input type="number" id="distance_value" name="distance" min="1" required>
      </div><br>

      <div id="quote_type">
        <label for="quote_type_select">Quote Type:</label>
        <select id="quote_type_select" name="quote_type" required>
          <option value="" disabled selected>-- Select Requestor Type --</option>
          <option value="customer">Customer</option>
          <option value="private">Private</option>
        </select>
      </div><br>


      <div id="weather">
        <label for="weather_select">Weather Condition:</label>
        <select id="weather_select" name="weather" required>
          <option value="" disabled selected>-- Select weather condition --</option>
          {% for key, weather_data in dynamic_modifiers.weather.items() %}
            <option value="{{ key }}">{{ weather_data.label }}</option>
          {% endfor %}
        </select>
      </div><br>

      <div id="truck_utilization_wrapper">
        <label for="truck_utilization_input">Enter Truck Utilization (%):</label>
        <input type="number" id="truck_utilization_input" name="truck_utilization" min="1" required>
      </div><br>



      <button type="submit">Calculate Quote</button>
    </form>

    <pre id="quote-result"></pre>
  </div>

  <!-- Embed pricing data for JS to read -->
  <script id="pricing-data" type="application/json">
    {{ pricing | tojson }}
  </script>

  <script id="cars-data" type="application/json">
  {{ cars|tojson|safe }}
</script>

  <!-- External JS -->
  <script src="{{ url_for('static', filename='quote.js') }}"></script>
</body>
</html>